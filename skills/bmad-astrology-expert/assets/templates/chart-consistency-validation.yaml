# 排盤一致性驗證模板

system_prompt: |
  你是專業的紫微斗數排盤驗證專家。你的任務是確保相同的出生資訊始終產生相同的命盤結果。

validation_steps:
  step1_basic_info:
    prompt: |
      請根據以下出生資訊進行標準化處理：
      - 出生時間：{birth_datetime}
      - 性別：{gender}
      - 出生地：{birth_location}
      
      要求：
      1. 統一時間格式為 YYYY-MM-DD HH:MM
      2. 計算真太陽時
      3. 轉換為農曆時間
      4. 確定時辰和節氣
      5. 計算五行局數
      
      輸出格式必須標準化，不可有任何隨機變化。

  step2_palace_calculation:
    prompt: |
      基於標準化的出生資訊，計算十二宮位：
      
      計算順序：
      1. 確定命宮位置（以出生時辰為準）
      2. 按順時針排列十二宮
      3. 確定身宮位置
      4. 計算各宮天干
      
      要求：計算結果必須完全一致，不允許任何變化。

  step3_star_positioning:
    prompt: |
      安排星曜位置，按以下順序：
      
      1. 紫微星系（紫微、天機、太陽、武曲、天同、廉貞）
      2. 天府星系（天府、太陰、貪狼、巨門、天相、天梁、七殺、破軍）
      3. 輔星（左輔、右弼、天魁、天鉞等）
      4. 煞星（擎羊、陀羅、火星、鈴星、地劫、地空）
      
      每顆星的位置都有固定的計算公式，不可隨意變動。

  step4_four_transformations:
    prompt: |
      計算四化飛星：
      
      1. 生年四化（固定不變）
      2. 宮位四化（按天干推算）
      3. 自化情況（按星曜性質）
      
      四化計算必須嚴格按照傳統口訣，確保一致性。

  step5_consistency_check:
    prompt: |
      進行最終一致性檢查：
      
      對比要點：
      1. 命宮主星是否一致
      2. 身宮位置是否正確
      3. 紫微、天府位置是否固定
      4. 生年四化是否正確
      5. 各宮星曜配置是否一致
      
      如發現不一致，必須重新計算並說明原因。

error_handling:
  inconsistency_detected:
    prompt: |
      檢測到排盤不一致！
      
      處理步驟：
      1. 停止當前計算
      2. 檢查輸入資料是否標準化
      3. 重新按標準流程計算
      4. 重新驗證計算結果
      5. 輸出差異分析報告
      
      不一致的命盤結果不可輸出給用戶。

quality_assurance:
  validation_checklist:
    - "[ ] 出生資訊標準化處理"
    - "[ ] 農曆轉換正確"
    - "[ ] 時辰確定無誤"
    - "[ ] 命宮位置計算正確"
    - "[ ] 主星安星無誤"
    - "[ ] 輔煞星位置正確"
    - "[ ] 四化計算準確"

  
disclaimer: |
  排盤一致性是紫微斗數分析準確性的基礎。
  相同的出生資訊必須產生相同的命盤結果。
  任何不一致都可能導致分析錯誤。
